@prefix qb4o: <http://purl.org/qb4olap/cubes#>.
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix qb: <http://purl.org/linked-data/cube#>.
@prefix dims: <http://www.fing.edu.uy/inco/cubes/hogaresINE/dsd/dimensions#> .
@prefix measures: <http://www.fing.edu.uy/inco/cubes/hogaresINE/dsd/measures#> .
@prefix hier: <http://www.fing.edu.uy/inco/cubes/hogaresINE/dsd/hierarchies#> .
@prefix cube: <http://www.fing.edu.uy/inco/cubes/hogaresINE/dsd/cubes#> .
@prefix att: <http://www.fing.edu.uy/inco/cubes/hogaresINE/dsd/attributes#> .
@prefix tableMap: <http://www.fing.edu.uy/inco/cubes/hogaresINE/dsd/tableMap#> .
@prefix dbmap: <http://www.example.com/dbmap#>.


#DIMENSIONES

dims:Tiempo a qb:DimensionProperty;
rdfs:label "Tiempo"@es;
qb4o:hasHierarchy hier:AnioTrimestreMes.

hier:AnioTrimestreMes a qb4o:HierarchyProperty;
rdfs:label "AnioTrimestreMes"@es;
qb4o:inDimension dims:Tiempo;
qb4o:hasLevel dims:Tiempo_Anio,dims:Tiempo_Trimestre,dims:Tiempo_Mes.

dims:Tiempo_Anio a qb4o:LevelProperty;
rdfs:label "Tiempo_Anio"@es;
qb4o:hasAtribute att:Tiempo_Anio_ColNombre;
qb4o:hasAtribute att:Tiempo_Anio_PK;
qb4o:hasID att:Tiempo_Anio_PK;
dbmap:isDsc att:Tiempo_Anio_ColNombre;
qb4o:inHierarchy hier:AnioTrimestreMes.

dims:Tiempo_Trimestre a qb4o:LevelProperty;
rdfs:label "Tiempo_Trimestre"@es;
qb4o:hasAtribute att:Tiempo_Trimestre_ColNombre;
qb4o:hasAtribute att:Tiempo_Trimestre_PK;
qb4o:hasID att:Tiempo_Trimestre_PK;
dbmap:isDsc att:Tiempo_Trimestre_ColNombre;
qb4o:inHierarchy hier:AnioTrimestreMes.

dims:Tiempo_Mes a qb4o:LevelProperty;
rdfs:label "Tiempo_Mes"@es;
qb4o:hasAtribute att:Tiempo_Mes_ColNombre;
qb4o:hasAtribute att:Tiempo_Mes_PK;
qb4o:hasID att:Tiempo_Mes_PK;
dbmap:isDsc att:Tiempo_Mes_ColNombre;
qb4o:inHierarchy hier:AnioTrimestreMes.

_:Tiempo_Anio_AnioTrimestreMes a qb4o:LevelInHierarchy ; qb4o:levelComponent dims:Tiempo_Anio ; qb4o:hierarchyComponent hier:AnioTrimestreMes.
_:Tiempo_Trimestre_AnioTrimestreMes a qb4o:LevelInHierarchy ; qb4o:levelComponent dims:Tiempo_Trimestre ; qb4o:hierarchyComponent hier:AnioTrimestreMes.
_:Tiempo_Mes_AnioTrimestreMes a qb4o:LevelInHierarchy ; qb4o:levelComponent dims:Tiempo_Mes ; qb4o:hierarchyComponent hier:AnioTrimestreMes.
_:Tiempo_Trimestre_Tiempo_Anio_AnioTrimestreMes a qb4o:HierarchyStep; qb4o:childLevel _:Tiempo_Trimestre_AnioTrimestreMes ; qb4o:parentLevel _:Tiempo_Anio_AnioTrimestreMes ; qb4o:cardinality qb4o:OneToMany.
_:Tiempo_Mes_Tiempo_Trimestre_AnioTrimestreMes a qb4o:HierarchyStep; qb4o:childLevel _:Tiempo_Mes_AnioTrimestreMes ; qb4o:parentLevel _:Tiempo_Trimestre_AnioTrimestreMes ; qb4o:cardinality qb4o:OneToMany.
#-------------------------------------------------------------------

dims:Confort a qb:DimensionProperty;
rdfs:label "Confort"@es;
qb4o:hasHierarchy hier:Confort.

hier:Confort a qb4o:HierarchyProperty;
rdfs:label "Confort"@es;
qb4o:inDimension dims:Confort;
qb4o:hasLevel dims:Confort_Confort.

dims:Confort_Confort a qb4o:LevelProperty;
rdfs:label "Confort_Confort"@es;
qb4o:hasAtribute att:Confort_Confort_ColNombre;
qb4o:hasAtribute att:Confort_Confort_PK;
qb4o:hasID att:Confort_Confort_PK;
dbmap:isDsc att:Confort_Confort_ColNombre;
qb4o:inHierarchy hier:Confort.

_:Confort_Confort_Confort a qb4o:LevelInHierarchy ; qb4o:levelComponent dims:Confort_Confort ; qb4o:hierarchyComponent hier:Confort.
#-------------------------------------------------------------------

dims:TipodeVivienda a qb:DimensionProperty;
rdfs:label "TipodeVivienda"@es;
qb4o:hasHierarchy hier:TipodeVivienda.

hier:TipodeVivienda a qb4o:HierarchyProperty;
rdfs:label "TipodeVivienda"@es;
qb4o:inDimension dims:TipodeVivienda;
qb4o:hasLevel dims:TipodeVivienda_TipoVivienda.

dims:TipodeVivienda_TipoVivienda a qb4o:LevelProperty;
rdfs:label "TipodeVivienda_TipoVivienda"@es;
qb4o:hasAtribute att:TipodeVivienda_TipoVivienda_ColNombre;
qb4o:hasAtribute att:TipodeVivienda_TipoVivienda_PK;
qb4o:hasID att:TipodeVivienda_TipoVivienda_PK;
dbmap:isDsc att:TipodeVivienda_TipoVivienda_ColNombre;
qb4o:inHierarchy hier:TipodeVivienda.

_:TipodeVivienda_TipoVivienda_TipodeVivienda a qb4o:LevelInHierarchy ; qb4o:levelComponent dims:TipodeVivienda_TipoVivienda ; qb4o:hierarchyComponent hier:TipodeVivienda.
#-------------------------------------------------------------------

att:nombre_Barrio a qb:AttrubuteProperty;
rdfs:label "nombre_Barrio"@es.
att:Tiempo_Anio_PK a qb:AttrubuteProperty;
rdfs:label "Tiempo_Anio_PK"@es.
att:Tiempo_Anio_ColNombre a qb:AttrubuteProperty;
rdfs:label "Tiempo_Anio_ColNombre"@es.
att:Confort_Confort_PK a qb:AttrubuteProperty;
rdfs:label "Confort_Confort_PK"@es.
att:Confort_Confort_ColNombre a qb:AttrubuteProperty;
rdfs:label "Confort_Confort_ColNombre"@es.
att:Tiempo_Trimestre_PK a qb:AttrubuteProperty;
rdfs:label "Tiempo_Trimestre_PK"@es.
att:Tiempo_Trimestre_ColNombre a qb:AttrubuteProperty;
rdfs:label "Tiempo_Trimestre_ColNombre"@es.
att:TipodeVivienda_TipoVivienda_PK a qb:AttrubuteProperty;
rdfs:label "TipodeVivienda_TipoVivienda_PK"@es.
att:TipodeVivienda_TipoVivienda_ColNombre a qb:AttrubuteProperty;
rdfs:label "TipodeVivienda_TipoVivienda_ColNombre"@es.
att:UbicacionGeografica_Localidad_PK a qb:AttrubuteProperty;
rdfs:label "UbicacionGeografica_Localidad_PK"@es.
att:UbicacionGeografica_Localidad_ColNombre a qb:AttrubuteProperty;
rdfs:label "UbicacionGeografica_Localidad_ColNombre"@es.
att:Tiempo_Mes_PK a qb:AttrubuteProperty;
rdfs:label "Tiempo_Mes_PK"@es.
att:Tiempo_Mes_ColNombre a qb:AttrubuteProperty;
rdfs:label "Tiempo_Mes_ColNombre"@es.


#MEDIDAS

measures:Hogares a qb:MeasureProperty;
rdfs:label "Hogares"@es.
measures:Personas a qb:MeasureProperty;
rdfs:label "Personas"@es.


#CUBOS

cube:req1 a qb:DataStructureDeÔ¨Ånition;
rdfs:label "req1"@es;
qb:component [qb4o:level dims:Tiempo_Mes ; qb4o:cardinality qb4o:ManyToOne];
qb:component [qb4o:level dims:Confort_Confort ; qb4o:cardinality qb4o:ManyToOne];
qb:component [qb4o:level dims:TipodeVivienda_TipoVivienda ; qb4o:cardinality qb4o:ManyToOne];
qb:component [qb:measure measures:Personas; qb4o:hasAggregateFunction qb4o:sum];
qb:component [qb:measure measures:Hogares; qb4o:hasAggregateFunction qb4o:sum].

#DATASET

cube:dataset_req1 a qb:DataSet;
rdfs:label "DataSet req1"@es;
qb:structure cube:req1.

#------------------------------------------------------------------


#Definicion de Tablas
#--------------------


#Anio
tableMap:anio a dbmap:Table; rdfs:label "anio".
tableMap:anioId a dbmap:Column; dbmap:hasSource tableMap:anio; rdfs:label "anioId".
tableMap:anioDsc a dbmap:Column; dbmap:hasSource tableMap:anio; rdfs:label "anioDsc".
att:Tiempo_Anio_PK dbmap:attributeColumn tableMap:anioId.
att:Tiempo_Anio_ColNombre dbmap:attributeColumn tableMap:anioDsc.

#Trimestre
tableMap:trimestre a dbmap:Table; rdfs:label "trimestre".
tableMap:TrimestreId a dbmap:Column; dbmap:hasSource tableMap:trimestre; rdfs:label "TrimestreId".
tableMap:TrimestreNombre a dbmap:Column; dbmap:hasSource tableMap:trimestre; rdfs:label "TrimestreNombre".
tableMap:TrimestreNum a dbmap:Column; dbmap:hasSource tableMap:trimestre; rdfs:label "TrimestreNum".
tableMap:TrimestreAnioId dbmap:hasSource tableMap:trimestre; rdfs:label "AnioId".
att:Tiempo_Trimestre_PK dbmap:attributeColumn tableMap:TrimestreId.
att:Tiempo_Trimestre_ColNombre dbmap:attributeColumn tableMap:TrimestreNombre.

#Mes
tableMap:mes a dbmap:Table; rdfs:label "mes".
tableMap:IDTIEMPO a dbmap:Column; dbmap:hasSource tableMap:mes; rdfs:label "IDTIEMPO".
tableMap:MesNombre a dbmap:Column; dbmap:hasSource tableMap:mes; rdfs:label "MesNombre".
tableMap:MesNum a dbmap:Column; dbmap:hasSource tableMap:mes; rdfs:label "MesNum".
tableMap:MesTrimestreId dbmap:hasSource tableMap:mes ; rdfs:label "TrimestreId".
att:Tiempo_Mes_PK dbmap:attributeColumn tableMap:IDTIEMPO.
att:Tiempo_Mes_ColNombre dbmap:attributeColumn tableMap:MesNombre.

#Join Mes-Trimestre-Anio
tableMap:AnioTrimestre a dbmap:Join; dbmap:joinLeftColumn tableMap:anioId; dbmap:joinRightColumn tableMap:TrimestreAnioId.
tableMap:TrimestreMes a dbmap:Join; dbmap:joinLeftColumn tableMap:TrimestreId; dbmap:joinRightColumn tableMap:MesTrimestreId.


#Confort
tableMap:Confort a dbmap:Table; rdfs:label "Confort".
tableMap:confort a dbmap:Column; dbmap:hasSource tableMap:Confort; rdfs:label "confort".
tableMap:confortName a dbmap:Column; dbmap:hasSource tableMap:Confort; rdfs:label "confort".
att:Confort_Confort_PK dbmap:attributeColumn tableMap:confort.
att:Confort_Confort_ColNombre dbmap:attributeColumn tableMap:confortName.

#Tipo de Vivienda
tableMap:TipoVivienda a dbmap:Table; rdfs:label "TipoVivienda".
tableMap:tipovivienda a dbmap:Column; dbmap:hasSource tableMap:TipoVivienda; rdfs:label "tipovivienda".
att:TipodeVivienda_TipoVivienda_PK dbmap:attributeColumn tableMap:tipovivienda.

#Req1 (Tabla de Hechos)
cube:req1 dbmap:cubeTable tableMap:Req1.
tableMap:Req1 a dbmap:Table; rdfs:label "Req1".
tableMap:confort a dbmap:Column; dbmap:hasSource tableMap:Req1; rdfs:label "confort".
tableMap:tipovivienda a dbmap:Column; dbmap:hasSource tableMap:Req1; rdfs:label "tipovivienda".
tableMap:tiempoid a dbmap:Column; dbmap:hasSource tableMap:Req1; rdfs:label "tiempoid".
tableMap:hogares a dbmap:Column; dbmap:hasSource tableMap:Req1; rdfs:label "hogares".
measures:cantHogares dbmap:measureColumn tableMap:hogares; rdfs:label "measures".
tableMap:personas a dbmap:Column; dbmap:hasSource tableMap:Req1; rdfs:label "personas".
measures:cantPersonas dbmap:measureColumn tableMap:personas.



